> algae[!complete.cases(algae),]
    season   size  speed mxPH mnO2    Cl   NO3 NH4    oPO4     PO4  Chla   a1
28  autumn  small   high 6.80 11.1 9.000 0.630  20   4.000      NA  2.70 30.3
38  spring  small   high 8.00   NA 1.450 0.810  10   2.500   3.000  0.30 75.8
48  winter  small    low   NA 12.6 9.000 0.230  10   5.000   6.000  1.10 35.5
55  winter  small   high 6.60 10.8    NA 3.245  10   1.000   6.500    NA 24.3
56  spring  small medium 5.60 11.8    NA 2.220   5   1.000   1.000    NA 82.7
57  autumn  small medium 5.70 10.8    NA 2.550  10   1.000   4.000    NA 16.8
58  spring  small   high 6.60  9.5    NA 1.320  20   1.000   6.000    NA 46.8
59  summer  small   high 6.60 10.8    NA 2.640  10   2.000  11.000    NA 46.9
60  autumn  small medium 6.60 11.3    NA 4.170  10   1.000   6.000    NA 47.1
61  spring  small medium 6.50 10.4    NA 5.970  10   2.000  14.000    NA 66.9
62  summer  small medium 6.40   NA    NA    NA  NA      NA  14.000    NA 19.4
63  autumn  small   high 7.83 11.7 4.083 1.328  18   3.333   6.667    NA 14.4
116 winter medium   high 9.70 10.8 0.222 0.406  10  22.444  10.111    NA 41.0
161 spring  large    low 9.00  5.8    NA 0.900 142 102.000 186.000 68.05  1.7
184 winter  large   high 8.00 10.9 9.055 0.825  40  21.083  56.091    NA 16.8
199 winter  large medium 8.00  7.6    NA    NA  NA      NA      NA    NA  0.0
      a2  a3   a4  a5  a6  a7
28   1.9 0.0  0.0 2.1 1.4 2.1
38   0.0 0.0  0.0 0.0 0.0 0.0
48   0.0 0.0  0.0 0.0 0.0 0.0
55   0.0 0.0  0.0 0.0 0.0 0.0
56   0.0 0.0  0.0 0.0 0.0 0.0
57   4.6 3.9 11.5 0.0 0.0 0.0
58   0.0 0.0 28.8 0.0 0.0 0.0
59   0.0 0.0 13.4 0.0 0.0 0.0
60   0.0 0.0  0.0 0.0 1.2 0.0
61   0.0 0.0  0.0 0.0 0.0 0.0
62   0.0 0.0  2.0 0.0 3.9 1.7
63   0.0 0.0  0.0 0.0 0.0 0.0
116  1.5 0.0  0.0 0.0 0.0 0.0
161 20.6 1.5  2.2 0.0 0.0 0.0
184 19.6 4.0  0.0 0.0 0.0 0.0
199 12.5 3.7  1.0 0.0 0.0 4.9
> manyNAs(algae)
[1]  62 199
> manyNAs(algae,0.2)
[1]  62 199
> x <- algae
> y <- na.omit(x)
> y
   season  size  speed mxPH  mnO2     Cl    NO3      NH4    oPO4     PO4   Chla
1  winter small medium 8.00  9.80 60.800  6.238  578.000 105.000 170.000 50.000
2  spring small medium 8.35  8.00 57.750  1.288  370.000 428.750 558.750  1.300
3  autumn small medium 8.10 11.40 40.020  5.330  346.667 125.667 187.057 15.600
4  spring small medium 8.07  4.80 77.364  2.302   98.182  61.182 138.700  1.400
5  autumn small medium 8.06  9.00 55.350 10.416  233.700  58.222  97.580 10.500
6  winter small   high 8.25 13.10 65.750  9.248  430.000  18.250  56.667 28.400
7  summer small   high 8.15 10.30 73.250  1.535  110.000  61.250 111.750  3.200
8  autumn small   high 8.05 10.60 59.067  4.990  205.667  44.667  77.434  6.900
9  winter small medium 8.70  3.40 21.950  0.886  102.750  36.300  71.000  5.544
10 winter small   high 7.93  9.90  8.000  1.390    5.800  27.250  46.600  0.800
11 spring small   high 7.70 10.20  8.000  1.527   21.571  12.750  20.750  0.800
12 summer small   high 7.45 11.70  8.690  1.588   18.429  10.667  19.000  0.600
13 winter small   high 7.74  9.60  5.000  1.223   27.286  12.000  17.000 41.000
14 summer small   high 7.72 11.80  6.300  1.470    8.000  16.000  15.000  0.500
15 winter small   high 7.90  9.60  3.000  1.448   46.200  13.000  61.600  0.300
16 autumn small   high 7.55 11.50  4.700  1.320   14.750   4.250  98.250  1.100
17 winter small   high 7.78 12.00  7.000  1.420   34.333  18.667  50.000  1.100
18 spring small   high 7.61  9.80  7.000  1.443   31.333  20.000  57.833  0.400
19 summer small   high 7.35 10.40  7.000  1.718   49.000  41.500  61.500  0.800
20 spring small medium 7.79  3.20 64.000  2.822 8777.600 564.600 771.600  4.500
21 winter small medium 7.83 10.70 88.000  4.825 1729.000 467.500 586.000 16.000
22 spring small   high 7.20  9.20  0.800  0.642   81.000  15.600  18.000  0.500
23 autumn small   high 7.75 10.30 32.920  2.942   42.000  16.000  40.000  7.600
24 winter small   high 7.62  8.50 11.867  1.715  208.333   3.000  27.500  1.700
25 spring small   high 7.84  9.40 10.975  1.510   12.500   3.000  11.500  1.500
26 summer small   high 7.77 10.70 12.536  3.976   58.500   9.000  44.136  3.000
27 winter small   high 7.09  8.40 10.500  1.572   28.000   4.000  13.600  0.500
29 winter small   high 8.00  9.80 16.000  0.730   20.000  26.000  45.000  0.800
30 spring small   high 7.20 11.30  9.000  0.230  120.000  12.000  19.000  0.500
31 autumn small   high 7.40 12.50 13.000  3.330   60.000  72.000 142.000  4.900
32 winter small   high 8.10 10.30 26.000  3.780   60.000 246.000 304.000  2.800
33 summer small   high 7.80 11.30 20.083  3.020   49.500  53.000 130.750  5.800
34 autumn small medium 8.40  9.90 34.500  2.818 3515.000  20.000  47.000  2.300
35 winter small medium 8.27  7.80 29.200  0.050 6400.000   7.400  23.000  0.900
36 summer small medium 8.66  8.40 30.523  3.444 1911.000  58.875  84.460  3.600
37 winter small   high 8.30 10.90  1.170  0.735   13.500   1.625   3.000  0.200
39 winter small medium 8.30  8.90 20.625  3.414  228.750 196.620 253.250 12.320
40 spring small medium 8.10 10.50 22.286  4.071  178.570 182.420 255.280  8.957
41 winter small medium 8.00  5.50 77.000  6.096  122.850 143.710 296.000  3.700
42 summer small medium 8.15  7.10 54.190  3.829  647.570  59.429 175.046 13.200
43 winter small   high 8.30  7.70 50.000  8.543   76.000 264.900 344.600 22.500
44 spring small   high 8.30  8.80 54.143  7.830   51.429 276.850 326.857 11.840
45 winter small   high 8.40 13.40 69.750  4.555   37.500  10.000  40.667  3.900
46 spring small   high 8.30 12.50 87.000  4.870   22.500  27.000  43.500  3.300
47 autumn small   high 8.00 12.10 66.300  4.535   39.000  16.000  39.000  0.800
49 spring small medium 7.60  9.60 15.000  3.020   40.000  27.000 121.000  2.800
50 autumn small medium 7.29 11.21 17.750  3.070   35.000  13.000  20.812 12.100
51 winter small medium 7.60 10.20 32.300  4.508  192.500  12.750  49.333  7.900
52 summer small medium 8.00  7.90 27.233  1.651   28.333   7.300  22.900  4.500
53 winter small   high 7.90 11.00  6.167  1.172   18.333   7.750  11.800  0.500
54 spring small   high 7.90  9.00  5.273  0.910   33.636   9.000  11.818  0.800
64 spring small   high 7.57 10.80  4.575  1.203   27.500   2.000   6.750  1.000
65 summer small   high 7.19 11.70  4.326  1.474  160.000   2.500   7.200  0.300
66 winter small   high 7.44 10.10  2.933  0.770   15.000   1.333   6.000  0.600
67 spring small   high 7.14  9.80  3.275  0.923   15.000   1.250  10.750  2.500
     a1   a2   a3   a4   a5   a6   a7
1   0.0  0.0  0.0  0.0 34.2  8.3  0.0
2   1.4  7.6  4.8  1.9  6.7  0.0  2.1
3   3.3 53.6  1.9  0.0  0.0  0.0  9.7
4   3.1 41.0 18.9  0.0  1.4  0.0  1.4
5   9.2  2.9  7.5  0.0  7.5  4.1  1.0
6  15.1 14.6  1.4  0.0 22.5 12.6  2.9
7   2.4  1.2  3.2  3.9  5.8  6.8  0.0
8  18.2  1.6  0.0  0.0  5.5  8.7  0.0
9  25.4  5.4  2.5  0.0  0.0  0.0  0.0
10 17.0  0.0  0.0  2.9  0.0  0.0  1.7
11 16.6  0.0  0.0  0.0  1.2  0.0  6.0
12 32.1  0.0  0.0  0.0  0.0  0.0  1.5
13 43.5  0.0  2.1  0.0  1.2  0.0  2.1
14 31.1  1.0  3.4  0.0  1.9  0.0  4.1
15 52.2  5.0  7.8  0.0  4.0  0.0  0.0
16 69.9  0.0  1.7  0.0  0.0  0.0  0.0
17 46.2  0.0  0.0  1.2  0.0  0.0  0.0
18 31.8  0.0  3.1  4.8  7.7  1.4  7.2
19 50.6  0.0  9.9  4.3  3.6  8.2  2.2
20  0.0  0.0  0.0 44.6  0.0  0.0  1.4
21  0.0  0.0  0.0  6.8  6.1  0.0  0.0
22 15.5  0.0  0.0  2.3  0.0  0.0  0.0
23 23.2  0.0  0.0  0.0 27.6 11.1  0.0
24 74.2  0.0  0.0  3.7  0.0  0.0  0.0
25 13.0  8.6  1.2  3.5  1.2  1.6  1.9
26  4.1  0.0  0.0  0.0  9.2 10.1  0.0
27 29.7  0.0  0.0  4.9  0.0  0.0  0.0
29 17.1  0.0 19.6  0.0  0.0  0.0  2.5
30 33.9  1.0 14.6  0.0  0.0  0.0  0.0
31  3.4 16.0  1.2  0.0 15.3 15.8  0.0
32  6.9 17.1 20.2  0.0  4.0  0.0  2.9
33  0.0  8.0  1.9  0.0 11.2 42.7  1.2
34 13.6  9.1  0.0  0.0  1.4  0.0  0.0
35  5.3 40.7  3.3  0.0  0.0  0.0  1.9
36 18.3 12.4  1.0  0.0  0.0  0.0  1.0
37 66.0  0.0  0.0  0.0  0.0  0.0  0.0
39  2.0 38.5  4.1  2.2  0.0  0.0 10.2
40  2.2  2.7  1.0  3.7  2.7  0.0  0.0
41  0.0  5.9 10.6  1.7  0.0  0.0  7.1
42  0.0  0.0  0.0  5.7 11.3 17.0  1.6
43  0.0 40.9  7.5  0.0  2.4  1.5  0.0
44  4.1  3.1  0.0  0.0 19.7 17.0  0.0
45 51.8  4.1  0.0  0.0  3.1  5.5  0.0
46 29.5  1.0  2.7  3.2  2.9  9.6  0.0
47 54.4  3.4  1.2  0.0 18.7  2.0  0.0
49 89.8  0.0  0.0  0.0  0.0  0.0  0.0
50 24.8  7.4  0.0  2.5 10.6 17.1  3.2
51  0.0  0.0  0.0  4.6  1.2  0.0  3.9
52 39.1  0.0  1.2  2.2  5.4  1.5  3.2
53 81.9  0.0  0.0  0.0  0.0  0.0  0.0
54 54.0  0.0  0.0  2.4  0.0  0.0  0.0
64 20.3  4.3  5.5  0.0  0.0  0.0  1.4
65 15.8  1.7  7.8  0.0  0.0  2.4  1.4
66 55.5  0.0  1.7  1.4  0.0  0.0  0.0
67 10.3  0.0 42.8  2.2  0.0  0.0  0.0
 [ reached 'max' / getOption("max.print") -- omitted 129 rows ]
> y[!complete.cases(y),]
 [1] season size   speed  mxPH   mnO2   Cl     NO3    NH4    oPO4   PO4   
[11] Chla   a1     a2     a3     a4     a5     a6     a7    
<0 行> (或0-长度的row.names)
> x<- algae[-c(62,199),]
> manyNAs(x)
named integer(0)
Warning message:
In manyNAs(x) :
  Empty index generated, no rows with many NAs. Undesirable effects may be caused if indexing a data frame with this.
  
> cor(algae[,4:18],use="complete.obs")
            mxPH        mnO2          Cl         NO3         NH4         oPO4
mxPH  1.00000000 -0.10269374  0.14709539 -0.17213024 -0.15429757  0.090229085
mnO2 -0.10269374  1.00000000 -0.26324536  0.11790769 -0.07826816 -0.393752688
Cl    0.14709539 -0.26324536  1.00000000  0.21095831  0.06598336  0.379255958
NO3  -0.17213024  0.11790769  0.21095831  1.00000000  0.72467766  0.133014517
NH4  -0.15429757 -0.07826816  0.06598336  0.72467766  1.00000000  0.219311206
oPO4  0.09022909 -0.39375269  0.37925596  0.13301452  0.21931121  1.000000000
PO4   0.10132957 -0.46396073  0.44519118  0.15702971  0.19939575  0.911964602
Chla  0.43182377 -0.13121671  0.14295776  0.14549290  0.09120406  0.106914784
a1   -0.16262986  0.24998372 -0.35923946 -0.24723921 -0.12360578 -0.394574479
a2    0.33501740 -0.06848199  0.07845402  0.01997079 -0.03790296  0.123811068
a3   -0.02716034 -0.23522831  0.07653027 -0.09182236 -0.11290467  0.005704557
a4   -0.18435348 -0.37982999  0.14147281 -0.01448875  0.27452000  0.382481433
a5   -0.10731230  0.21001174  0.14534877  0.21213579  0.01544458  0.122027482
a6   -0.17273795  0.18862656  0.16904394  0.54404455  0.40119275  0.003340366
a7   -0.17027088 -0.10455106 -0.04494524  0.07505030 -0.02539279  0.026150420
             PO4        Chla          a1           a2           a3          a4
mxPH  0.10132957  0.43182377 -0.16262986  0.335017401 -0.027160336 -0.18435348
mnO2 -0.46396073 -0.13121671  0.24998372 -0.068481989 -0.235228307 -0.37982999
Cl    0.44519118  0.14295776 -0.35923946  0.078454019  0.076530269  0.14147281
NO3   0.15702971  0.14549290 -0.24723921  0.019970786 -0.091822358 -0.01448875
NH4   0.19939575  0.09120406 -0.12360578 -0.037902958 -0.112904666  0.27452000
oPO4  0.91196460  0.10691478 -0.39457448  0.123811068  0.005704557  0.38248143
PO4   1.00000000  0.24849223 -0.45816781  0.132667891  0.032193981  0.40883951
Chla  0.24849223  1.00000000 -0.26601088  0.366724647 -0.063301128 -0.08600540
a1   -0.45816781 -0.26601088  1.00000000 -0.262665485 -0.108177581 -0.09338072
a2    0.13266789  0.36672465 -0.26266549  1.000000000  0.009759915 -0.17628704
a3    0.03219398 -0.06330113 -0.10817758  0.009759915  1.000000000  0.03336910
a4    0.40883951 -0.08600540 -0.09338072 -0.176287038  0.033369102  1.00000000
a5    0.15548900 -0.07342837 -0.26972709 -0.186758940 -0.141610948 -0.10131827
a6    0.05320294  0.01032550 -0.26156402 -0.133518480 -0.196900051 -0.08488426
a7    0.07978353  0.01760782 -0.19306384  0.036206205  0.039060248  0.07114638
              a5           a6          a7
mxPH -0.10731230 -0.172737947 -0.17027088
mnO2  0.21001174  0.188626555 -0.10455106
Cl    0.14534877  0.169043945 -0.04494524
NO3   0.21213579  0.544044553  0.07505030
NH4   0.01544458  0.401192749 -0.02539279
oPO4  0.12202748  0.003340366  0.02615042
PO4   0.15548900  0.053202942  0.07978353
Chla -0.07342837  0.010325497  0.01760782
a1   -0.26972709 -0.261564023 -0.19306384
a2   -0.18675894 -0.133518480  0.03620621
a3   -0.14161095 -0.196900051  0.03906025
a4   -0.10131827 -0.084884259  0.07114638
a5    1.00000000  0.388608955 -0.05149346
a6    0.38860896  1.000000000 -0.03033428
a7   -0.05149346 -0.030334277  1.00000000
> symnum(cor(algae[,4:18],use="complete.obs"))
     mP mO Cl NO NH o P Ch a1 a2 a3 a4 a5 a6 a7
mxPH 1                                         
mnO2    1                                      
Cl         1                                   
NO3           1                                
NH4           ,  1                             
oPO4    .  .        1                          
PO4     .  .        * 1                        
Chla .                  1                      
a1         .        . .    1                   
a2   .                  .     1                
a3                               1             
a4      .           . .             1          
a5                                     1       
a6            .  .                     .  1    
a7                                           1 
attr(,"legend")
[1] 0 ‘ ’ 0.3 ‘.’ 0.6 ‘,’ 0.8 ‘+’ 0.9 ‘*’ 0.95 ‘B’ 1
> x <- algae[-manyNAs(algae),]
> lm(PO4~oPO4,data=x)

Call:
lm(formula = PO4 ~ oPO4, data = x)

Coefficients:
(Intercept)         oPO4  
     42.897        1.293  
